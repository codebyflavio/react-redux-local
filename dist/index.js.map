{"version":3,"file":"index.js","sources":["../src/LocalReducer.js","../src/Prevent.js","../src/Context.js"],"sourcesContent":["import { Component } from 'react'\nimport { func, objectOf, arrayOf, object } from 'prop-types'\nimport {\n  createStore,\n  applyMiddleware,\n  bindActionCreators,\n  compose,\n} from 'redux'\nimport createSagaMiddleware from 'redux-saga'\n\nclass LocalReducer extends Component {\n  constructor(props) {\n    super(props)\n\n    const { reducer, saga, middleware, actions, devToolsOptions } = props\n\n    this.sagaMiddleware = saga && createSagaMiddleware && createSagaMiddleware()\n\n    const allMiddleware = [...middleware]\n\n    if (this.sagaMiddleware) allMiddleware.push(this.sagaMiddleware)\n\n    const enhancers = applyMiddleware(...allMiddleware)\n\n    const composeEnhancers =\n      typeof window === 'object' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n        ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(devToolsOptions)\n        : compose\n\n    this.state = reducer(undefined, {})\n\n    this.store = createStore(\n      reducer,\n      devToolsOptions ? composeEnhancers(enhancers) : enhancers,\n    )\n\n    this.store.subscribe(() => this.setState(this.store.getState()))\n    if (this.sagaMiddleware) this.saga = this.sagaMiddleware.run(saga)\n\n    this.boundActions = bindActionCreators(actions, this.dispatch)\n  }\n\n  componentWillUnMount() {\n    if (this.sagaMiddleware) this.saga.cancel()\n  }\n\n  dispatch = (action = {}) => this.store.dispatch(action)\n\n  render() {\n    return this.props.children(this.state, this.boundActions, this.dispatch)\n  }\n}\n\nLocalReducer.propTypes = {\n  reducer: func.isRequired,\n  actions: objectOf(func.isRequired).isRequired,\n  saga: func,\n  middleware: arrayOf(func.isRequired),\n  children: func.isRequired,\n  devToolsOptions: object,\n}\n\nLocalReducer.defaultProps = {\n  middleware: [],\n}\n\nexport default LocalReducer\n","import { PureComponent } from 'react'\n\nexport default class extends PureComponent {\n  render() {\n    const { children, state, actions, dispatch } = this.props\n\n    return children(state, actions, dispatch)\n  }\n}\n","import React from 'react'\n\nimport LocalReducer from './LocalReducer'\nimport Prevent from './Prevent'\n\nexport default props => {\n  if (!props.reducer) throw new Error('A reducer must be provided.')\n  if (!props.actions) throw new Error('A set of actions must be provided.')\n  const Context = React.createContext()\n\n  const defaultMap = () => undefined\n\n  const Provider = ({ children }) => (\n    <LocalReducer {...props}>\n      {(state, actions, dispatch) => (\n        <Context.Provider value={{ state, actions, dispatch }}>\n          {children}\n        </Context.Provider>\n      )}\n    </LocalReducer>\n  )\n\n  const Consumer = ({\n    children,\n    mapState = defaultMap,\n    mapActions = defaultMap,\n  }) => (\n    <Context.Consumer>\n      {({ state, actions, dispatch }) => (\n        <Prevent\n          state={mapState(state)}\n          actions={mapActions(actions, dispatch)}\n          dispatch={dispatch}\n        >\n          {children}\n        </Prevent>\n      )}\n    </Context.Consumer>\n  )\n\n  const useDispatch = () => {\n    const { dispatch } = React.useContext(Context)\n\n    return dispatch\n  }\n\n  const useState = (mapState = defaultMap) => {\n    const { state } = React.useContext(Context)\n\n    return mapState(state)\n  }\n\n  const useActions = (mapActions = defaultMap) => {\n    const { actions } = React.useContext(Context)\n\n    return mapActions(actions)\n  }\n\n  return {\n    Provider,\n    Consumer,\n    useDispatch,\n    useState,\n    useActions,\n  }\n}\n"],"names":["LocalReducer","props","action","store","dispatch","reducer","saga","middleware","actions","devToolsOptions","sagaMiddleware","createSagaMiddleware","allMiddleware","push","enhancers","applyMiddleware","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","state","undefined","createStore","subscribe","setState","getState","run","boundActions","bindActionCreators","cancel","children","Component","propTypes","func","isRequired","objectOf","arrayOf","object","defaultProps","PureComponent","Error","Context","React","createContext","defaultMap","Provider","Consumer","mapState","mapActions","Prevent","useDispatch","useContext","useState","useActions"],"mappings":"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"}